<html>
	<head>
	<script>

		document.addEventListener('DOMContentLoaded', function() {
				// ti.api can be accessed after domcontentloaded on parent page
				// use this instead of body onload
				Ti.API.info('DOMContentLoaded called');
				
			  	var win = document.getElementById("iframe").contentWindow;
				var eventMethod = win.addEventListener ? "addEventListener" : "attachEvent";
				var eventer = win[eventMethod];
				var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";
				// var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "messagefromchild";

				// var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
				// var eventer = window[eventMethod];
				// var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";

				// Listen to message from child window
				eventer(messageEvent,function(e) {
					Ti.API.info('inside parent called');
				  // alert('parent received message!:  ',e.data);
				},false);
		});

		function setUp(){
	        // alert('setup the index: parent knows frames length '+window.frames.length);
				Ti.API.info('setup called');


        		// #rainer this needs different help to access the iframe, test different onload delays when the document is to be ready.
        		// and to set up postMessage api listeners
        		
			  	// var win = document.getElementById("iframe").contentWindow;
				// win.addEventListener("messagefromchild", function(e){
				
				// window.addEventListener("message", function(e){
			 //        document.getElementById("myiframe").src = e.data;
				// }, false);

		}
	</script>
	</head>
	<body onload="setUp()">
	<!-- <body> -->
		<!-- if loaded dynamic html needs full path from resources folder "iframetest/blank.html"-->
		<!-- but if blob with baseurl then just put the relative blank.html -->
	<!-- <iframe id="myiframe" src="blank.html" frameborder="0" style="overflow:hidden;height:100vh;width:100vw" ></iframe> -->
	<iframe id="myiframe" src="blank_withscript_postmessage.html"></iframe>
	<!-- <iframe id="myiframe" src="blank.html" ></iframe> -->
	</body>
</html>